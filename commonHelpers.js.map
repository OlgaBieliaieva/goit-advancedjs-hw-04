{"version":3,"file":"commonHelpers.js","sources":["../src/get-images.js","../src/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/?';\nconst REQUEST_OPTIONS = {\n  key: '34369155-5d93acadffc22e75da017de5a',\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n  page: 1,\n};\n\nexport async function getImages(value) {\n  if (REQUEST_OPTIONS.q !== value) {\n    REQUEST_OPTIONS.q = value;\n    REQUEST_OPTIONS.page = 1;\n  }\n\n  const options = new URLSearchParams(REQUEST_OPTIONS);\n  const response = await axios.get(`${BASE_URL}${options}`);\n\n  REQUEST_OPTIONS.page += 1;\n\n  return response.data;\n}\n","import './css/styles.css';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { getImages } from './get-images';\n\nconst refs = {\n  searchForm: document.querySelector('.search-form'),\n  searchFormInput: document.querySelector('.search-form input'),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nrefs.searchForm.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\nlet queryValue = '';\nlet perPage = 40;\nlet page = 0;\n\nfunction onSearch(event) {\n  event.preventDefault();\n\n  const {\n    elements: { searchQuery },\n  } = event.currentTarget;\n\n  if (searchQuery.value.length === 0) {\n    return;\n  } else if (searchQuery.value.trim().toLowerCase() === queryValue) {\n    iziToast.warning({\n      message: 'Search results are already displayed.',\n    });\n    return;\n  } else {\n    page = 0;\n    refs.gallery.innerHTML = '';\n    refs.loadMoreBtn.classList.add('is-hidden');\n    queryValue = searchQuery.value.trim().toLowerCase();\n    getImagesByQuery(queryValue);\n  }\n}\n\nasync function getImagesByQuery(query) {\n  try {\n    const data = await getImages(query);\n    page += 1;\n    checkResult(data);\n  } catch (error) {\n    showError();\n  }\n}\n\nasync function onLoadMore(e) {\n  getImagesByQuery(queryValue);\n}\n\nfunction checkResult(data) {\n  if (data.totalHits === 0) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n    });\n    refs.searchFormInput.value = '';\n    return;\n  } else {\n    createGalleryMarkup(data.hits);\n\n    if (page === 1) {\n      iziToast.success({\n        title: 'Hooray!',\n        message: `We found ${data.totalHits} images.`,\n      });\n\n      if (data.totalHits > perPage) {\n        refs.loadMoreBtn.classList.remove('is-hidden');\n      }\n    } else if (data.hits.length < perPage) {\n      refs.loadMoreBtn.classList.add('is-hidden');\n      iziToast.warning({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  }\n}\n\nfunction createGalleryMarkup(hits) {\n  const galleryMarkup = hits\n    .map(\n      element => `<a class=\"item\" href=\"${element.largeImageURL}\">\n      <div class=\"photo-card\">\n  <img src=\"${element.webformatURL}\" alt=\"${element.tags}\" loading=\"lazy\" />\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>Likes ${element.likes}</b>\n    </p>\n    <p class=\"info-item\">\n      <b>Views ${element.views}</b>\n    </p>\n    <p class=\"info-item\">\n      <b>Comments ${element.comments}</b>\n    </p>\n    <p class=\"info-item\">\n      <b>Downloads ${element.downloads}</b>\n    </p>\n  </div>\n</div></a>`\n    )\n    .join('');\n  showGallery(galleryMarkup);\n}\n\nfunction showGallery(markup) {\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nfunction showError(error) {\n  console.log(error);\n  iziToast.error({\n    message: 'Sorry, something went wrong... Please try again.',\n  });\n}\n"],"names":["BASE_URL","REQUEST_OPTIONS","getImages","value","options","response","axios","refs","onSearch","onLoadMore","lightbox","SimpleLightbox","queryValue","perPage","page","event","searchQuery","iziToast","getImagesByQuery","query","data","checkResult","showError","createGalleryMarkup","hits","galleryMarkup","element","showGallery","markup","error"],"mappings":"+vBAEA,MAAMA,EAAW,4BACXC,EAAkB,CACtB,IAAK,qCACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAM,CACR,EAEO,eAAeC,EAAUC,EAAO,CACjCF,EAAgB,IAAME,IACxBF,EAAgB,EAAIE,EACpBF,EAAgB,KAAO,GAGzB,MAAMG,EAAU,IAAI,gBAAgBH,CAAe,EAC7CI,EAAW,MAAMC,EAAM,IAAI,GAAGN,IAAWI,GAAS,EAExD,OAAAH,EAAgB,MAAQ,EAEjBI,EAAS,IAClB,CCnBA,MAAME,EAAO,CACX,WAAY,SAAS,cAAc,cAAc,EACjD,gBAAiB,SAAS,cAAc,oBAAoB,EAC5D,QAAS,SAAS,cAAc,UAAU,EAC1C,YAAa,SAAS,cAAc,YAAY,CAClD,EAEAA,EAAK,WAAW,iBAAiB,SAAUC,CAAQ,EACnDD,EAAK,YAAY,iBAAiB,QAASE,CAAU,EAErD,MAAMC,EAAW,IAAIC,EAAe,YAAY,EAEhD,IAAIC,EAAa,GACbC,EAAU,GACVC,EAAO,EAEX,SAASN,EAASO,EAAO,CACvBA,EAAM,eAAc,EAEpB,KAAM,CACJ,SAAU,CAAE,YAAAC,CAAa,CAC7B,EAAMD,EAAM,cAEV,GAAIC,EAAY,MAAM,SAAW,EAE1B,GAAIA,EAAY,MAAM,KAAI,EAAG,YAAa,IAAKJ,EAAY,CAChEK,EAAS,QAAQ,CACf,QAAS,uCACf,CAAK,EACD,MACJ,MACIH,EAAO,EACPP,EAAK,QAAQ,UAAY,GACzBA,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1CK,EAAaI,EAAY,MAAM,KAAM,EAAC,YAAW,EACjDE,EAAiBN,CAAU,CAE/B,CAEA,eAAeM,EAAiBC,EAAO,CACrC,GAAI,CACF,MAAMC,EAAO,MAAMlB,EAAUiB,CAAK,EAClCL,GAAQ,EACRO,EAAYD,CAAI,CACjB,MAAC,CACAE,GACD,CACH,CAEA,eAAeb,EAAW,EAAG,CAC3BS,EAAiBN,CAAU,CAC7B,CAEA,SAASS,EAAYD,EAAM,CACzB,GAAIA,EAAK,YAAc,EAAG,CACxBH,EAAS,MAAM,CACb,QACE,0EACR,CAAK,EACDV,EAAK,gBAAgB,MAAQ,GAC7B,MACJ,MACIgB,EAAoBH,EAAK,IAAI,EAEzBN,IAAS,GACXG,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,YAAYG,EAAK,mBAClC,CAAO,EAEGA,EAAK,UAAYP,GACnBN,EAAK,YAAY,UAAU,OAAO,WAAW,GAEtCa,EAAK,KAAK,OAASP,IAC5BN,EAAK,YAAY,UAAU,IAAI,WAAW,EAC1CU,EAAS,QAAQ,CACf,QAAS,4DACjB,CAAO,EAGP,CAEA,SAASM,EAAoBC,EAAM,CACjC,MAAMC,EAAgBD,EACnB,IACCE,GAAW,yBAAyBA,EAAQ;AAAA;AAAA,cAEpCA,EAAQ,sBAAsBA,EAAQ;AAAA;AAAA;AAAA,iBAGnCA,EAAQ;AAAA;AAAA;AAAA,iBAGRA,EAAQ;AAAA;AAAA;AAAA,oBAGLA,EAAQ;AAAA;AAAA;AAAA,qBAGPA,EAAQ;AAAA;AAAA;AAAA,WAIxB,EACA,KAAK,EAAE,EACVC,EAAYF,CAAa,CAC3B,CAEA,SAASE,EAAYC,EAAQ,CAC3BrB,EAAK,QAAQ,mBAAmB,YAAaqB,CAAM,EACnDlB,EAAS,QAAO,CAClB,CAEA,SAASY,EAAUO,EAAO,CACxB,QAAQ,IAAIA,CAAK,EACjBZ,EAAS,MAAM,CACb,QAAS,kDACb,CAAG,CACH"}